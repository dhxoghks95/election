---
layout: page
title: "대한민국 제21대 국회의원 선거"
subtitle: "실시간 여론조사"
author:
    name: "[Tidyverse Korea](https://www.facebook.com/groups/tidyverse/)"
date: "`r Sys.Date()`"
output:
  html_document: 
    toc: yes
    toc_float: true
    highlight: tango
    code_folding: hide
    number_section: true
    self_contained: true
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE,
                      comment="", digits = 3, tidy = FALSE, prompt = FALSE, fig.align = 'center')

```

# 여론조사 데이터 {#election-polls}

```{r polls-get-data}
# 0. 환경설정 -----
library(tidyverse)
library(rvest)
library(httr)

polls_url <- "https://namu.wiki/w/%EC%A0%9C21%EB%8C%80%20%EA%B5%AD%ED%9A%8C%EC%9D%98%EC%9B%90%20%EC%84%A0%EA%B1%B0/%EC%97%AC%EB%A1%A0%EC%A1%B0%EC%82%AC"

Sys.setlocale("LC_ALL", "C")

polls_dat <- polls_url %>% 
  read_html() %>% 
  html_nodes(css="table") %>% 
  html_table(fill=TRUE)

Sys.setlocale("LC_ALL", "Korean")

리서치뷰_lgl <- map_lgl(map(polls_dat, str_detect, "리서치뷰 "), any)

리서치뷰_lst <- polls_dat[리서치뷰_lgl]

리서치뷰_lst[[1]] %>% 
  janitor::clean_names() %>% 
  slice(2:n()) %>% 
  gather(key, value)

```

